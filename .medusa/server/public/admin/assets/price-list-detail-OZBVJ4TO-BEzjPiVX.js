import{L as F}from"./chunk-I3VB6NM2-Bvk2607e.js";import{u as H}from"./chunk-FX3ZJWB6-DbMaT11i.js";import{g as Q}from"./chunk-G2J2T2QU-CbO33z3W.js";import{D as I}from"./chunk-BMMZXUUC-BIlXkZUv.js";import{u as M}from"./chunk-G3QXMPRB-C1Q-HUIl.js";import{R as $,dD as w,a as J,j as e,S as K,s as W,dE as Y,q as G,b as u,H as j,A as m,T as d,u as X,r as C,e as Z,k as U,dF as L,W as V,t as p,dC as ee,aA as se}from"./index-Bdq-MROr.js";import{u as te,_ as ie}from"./chunk-X3LH6P65-DKtaW8EL.js";import"./lodash-C2hq8pbl.js";import{u as re,a as ae}from"./chunk-IPEN5VX6-BPxUBoYO.js";import"./chunk-TMAS4ILY-BC55oDaY.js";import{T as g}from"./chunk-2RQLKDBF-DzIu_1_y.js";import{P as x}from"./pencil-square-C74A9tK5.js";import{T as k}from"./trash-bcUEvN9u.js";import{u as T}from"./use-prompt-DOzEld64.js";import{C as y}from"./container-BzJLPZyc.js";import{S as oe}from"./status-badge-Du1zePF5.js";import{c as ce}from"./index-C_94Z_JG.js";import{C as P}from"./checkbox-VL5BGotg.js";import"./chunk-6GU6IDUA-CDc7wW5L.js";import"./chunk-DV5RB7II-DtU2pt1o.js";import"./format-8mLkbana.js";import"./chunk-IQBAUTU5-BuWJL9w3.js";import"./chunk-ADOCJB6L-ElwuTybw.js";import"./chunk-P3UUX2T6-DP-uJG0A.js";import"./chunk-YEDAFXMB-DIxdwx5k.js";import"./chunk-AOFGTNG6-RI3t2jUY.js";import"./table-Q1A-VKSz.js";import"./chunk-WX2SMNCD-hJQYH_de.js";import"./plus-mini-BM4coq2a.js";import"./command-bar-AGFlR-E0.js";import"./index-Bbqi4xRY.js";import"./chunk-C76H5USB-CzxDnEm6.js";import"./_isIndex-C4iy1AGn.js";import"./x-mark-mini-WtBfAEyd.js";import"./index-BAXH-T8O.js";import"./date-picker-CQaZo_tA.js";import"./clsx-B-dksMZM.js";import"./popover-wEuZpluk.js";import"./triangle-left-mini-BJGlQY3c.js";import"./Trans-Dd1q9-dO.js";import"./check-CizfQ2P9.js";import"./prompt-Is_Gz9sa.js";var is=i=>{const{id:s}=i.params||{},{price_list:t}=w(s,void 0,{initialData:i.data,enabled:!!s});return t?e.jsx("span",{children:t.title}):null},ne=i=>({queryKey:Y.detail(i),queryFn:async()=>W.admin.priceList.retrieve(i)}),rs=async({params:i})=>{const s=i.id,t=ne(s);return G.ensureQueryData(t)},le=({priceList:i})=>{const{t:s}=u();return e.jsxs(y,{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{level:"h2",children:s("priceLists.configuration.header")}),e.jsx(de,{priceList:i})]}),e.jsx(m,{groups:[{actions:[{label:s("actions.edit"),to:"configuration",icon:e.jsx(x,{})}]}]})]}),e.jsx(I,{endsAt:i.ends_at,startsAt:i.starts_at,showTime:!0})]})},de=({priceList:i})=>{const{t:s}=u(),t=i.rules.customer_group_id,{customer_groups:r,isPending:a,isError:o,error:n}=ee({id:t},{enabled:!!(t!=null&&t.length)});if(o)throw n;return t!=null&&t.length?a||!r?e.jsx(se,{className:"h-5 w-full max-w-48"}):e.jsxs("div",{className:"txt-small-plus text-ui-fg-muted flex items-center gap-x-1.5",children:[e.jsx("span",{className:"text-ui-fg-subtle",children:s("priceLists.fields.customerAvailability.attribute")}),e.jsx("span",{children:"Â·"}),e.jsx(F,{list:r.map(c=>c.name),n:1,className:"txt-small-plus text-ui-fg-muted"})]}):null},ue=({priceList:i})=>{var c;const{t:s}=u(),t=((c=i.prices)==null?void 0:c.length)||0,{color:r,text:a}=Q(s,i),o=H({priceList:i}),n=i.type==="sale"?s("priceLists.fields.type.options.sale.label"):s("priceLists.fields.type.options.override.label");return e.jsxs(y,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{children:i.title}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(oe,{color:r,children:a}),e.jsx(m,{groups:[{actions:[{label:s("actions.edit"),to:"edit",icon:e.jsx(x,{})}]},{actions:[{label:s("actions.delete"),onClick:o,icon:e.jsx(k,{})}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{leading:"compact",size:"small",weight:"plus",children:s("fields.type")}),e.jsx(d,{size:"small",className:"text-pretty",children:n})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{leading:"compact",size:"small",weight:"plus",children:s("fields.description")}),e.jsx(d,{size:"small",className:"text-pretty",children:i.description})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{leading:"compact",size:"small",weight:"plus",children:s("priceLists.fields.priceOverrides.label")}),e.jsx(d,{size:"small",className:"text-pretty",children:t||"-"})]})]})},f=10,h="p",pe=({priceList:i})=>{const{t:s}=u(),t=X(),r=T(),[a,o]=C.useState({}),{searchParams:n,raw:c}=re({pageSize:f,prefix:h}),{products:N,count:b,isLoading:D,isError:_,error:A}=Z({...n,price_list_id:[i.id]},{placeholderData:U}),E=ae(),v=xe(i),{mutateAsync:R}=L(i.id),{table:z}=te({data:N||[],count:b,columns:v,enablePagination:!0,enableRowSelection:!0,pageSize:f,getRowId:l=>l.id,rowSelection:{state:a,updater:o},prefix:h}),O=async()=>{await r({title:s("general.areYouSure"),description:s("priceLists.products.delete.confirmation",{count:Object.keys(a).length}),confirmText:s("actions.delete"),cancelText:s("actions.cancel")})&&R({remove:Object.keys(a)},{onSuccess:()=>{p.success(s("priceLists.products.delete.successToast",{count:Object.keys(a).length})),o({})},onError:B=>{p.error(B.message)}})},q=async()=>{const l=Object.keys(a).join(",");t(`products/edit?ids[]=${l}`)};if(_)throw A;return e.jsxs(y,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{children:s("priceLists.products.header")}),e.jsx(m,{groups:[{actions:[{label:s("priceLists.products.actions.addProducts"),to:"products/add",icon:e.jsx(V,{})},{label:s("priceLists.products.actions.editPrices"),to:"products/edit",icon:e.jsx(x,{})}]}]})]}),e.jsx(ie,{table:z,filters:E,columns:v,count:b,pageSize:f,isLoading:D,navigateTo:l=>`/products/${l.original.id}`,orderBy:[{key:"title",label:s("fields.title")},{key:"created_at",label:s("fields.createdAt")},{key:"updated_at",label:s("fields.updatedAt")}],commands:[{action:q,label:s("actions.edit"),shortcut:"e"},{action:O,label:s("actions.delete"),shortcut:"d"}],pagination:!0,search:!0,prefix:h,queryObject:c})]})},me=({product:i,priceList:s})=>{const{t}=u(),r=T(),{mutateAsync:a}=L(s.id),o=async()=>{await r({title:t("general.areYouSure"),description:t("priceLists.products.delete.confirmation",{count:1}),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&a({remove:[i.id]},{onSuccess:()=>{p.success(t("priceLists.products.delete.successToast",{count:1}))},onError:c=>{p.error(c.message)}})};return e.jsx(m,{groups:[{actions:[{icon:e.jsx(x,{}),label:t("priceLists.products.actions.editPrices"),to:`products/edit?ids[]=${i.id}`}]},{actions:[{icon:e.jsx(k,{}),label:t("actions.remove"),onClick:o}]}]})},S=ce(),xe=i=>{const s=M();return C.useMemo(()=>[S.display({id:"select",header:({table:t})=>e.jsx(P,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:r=>t.toggleAllPageRowsSelected(!!r)}),cell:({row:t})=>e.jsx(P,{checked:t.getIsSelected(),onCheckedChange:r=>t.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}})}),...s,S.display({id:"actions",cell:({row:t})=>e.jsx(me,{product:t.original,priceList:i})})],[s,i])},as=()=>{const{id:i}=$(),{price_list:s,isLoading:t,isError:r,error:a}=w(i),{getWidgets:o}=J();if(t||!s)return e.jsx(K,{mainSections:2,sidebarSections:1,showJSON:!0});if(r)throw a;return e.jsxs(g,{widgets:{after:o("price_list.details.after"),before:o("price_list.details.before"),sideAfter:o("price_list.details.side.after"),sideBefore:o("price_list.details.side.before")},data:s,showJSON:!0,children:[e.jsxs(g.Main,{children:[e.jsx(ue,{priceList:s}),e.jsx(pe,{priceList:s})]}),e.jsx(g.Sidebar,{children:e.jsx(le,{priceList:s})})]})};export{is as Breadcrumb,as as Component,rs as loader};
